* Johan Hattne
  Prefix patches
* grobian: fixing + quoting

--- motif-config-0.10
+++ motif-config-0.10
@@ -1,4 +1,4 @@
-#!/bin/bash
+#!@GENTOO_PORTAGE_EPREFIX@/bin/bash
 # Copyright 1999-2004 Gentoo Foundation
 # Distributed under the terms of the GNU General Public License v2
 # based on gcc-config by Martin Schlemmer <azarah@gentoo.org
@@ -6,7 +6,8 @@
 
 umask 022
 
-PROFILE_PATH=/usr/@@LIBDIR@@/motif
+EPREFIX=@GENTOO_PORTAGE_EPREFIX@
+PROFILE_PATH=${EPREFIX}/usr/@@LIBDIR@@/motif
 CONFIG_FILE=${PROFILE_PATH}/current
 
 usage() {
@@ -51,8 +52,12 @@
 }
 
 _check_root() {
-	if [[ "$(id -u)" -ne 0 ]] ; then
-		eerror "$0: Must be root."
+	if [ ! -w ${PROFILE_PATH} \
+	  -o ! -w "${EPREFIX}"/usr/bin \
+	  -o ! -w "${EPREFIX}"/usr/include \
+	  -o ! -w "${EPREFIX}"/usr/@@LIBDIR@@ \
+	  -o ! -w "${EPREFIX}"/usr/share/man ]; then
+		eerror "$0: Must have proper permissions."
 		exit 1
 	fi
 }
@@ -69,28 +74,28 @@
 	new=${1}
 	files=""
 	# libs
-	for file in `ls /usr/@@LIBDIR@@/${new}/ | grep lib`; do
-		files="${files} /usr/@@LIBDIR@@/${file}"
-		rm -rf /usr/@@LIBDIR@@/${file}
+	for file in `ls "${EPREFIX}"/usr/@@LIBDIR@@/${new}/ | grep lib`; do
+		files="${files} ${EPREFIX}/usr/@@LIBDIR@@/${file}"
+		rm -rf "${EPREFIX}"/usr/@@LIBDIR@@/${file}
 		retval=$((retval | $? ))
-		ln -s /usr/@@LIBDIR@@/${new}/${file} /usr/@@LIBDIR@@/${file}
+		ln -s "${EPREFIX}"/usr/@@LIBDIR@@/${new}/${file} "${EPREFIX}"/usr/@@LIBDIR@@/${file}
 		retval=$((retval | $? ))
 	done
 	# includes
-	for file in `ls /usr/include/${new}/`; do
-		files="${files} /usr/include/${file}"
-		rm -rf /usr/include/${file}
+	for file in `ls "${EPREFIX}"/usr/include/${new}/`; do
+		files="${files} ${EPREFIX}/usr/include/${file}"
+		rm -rf "${EPREFIX}"/usr/include/${file}
 		retval=$((retval | $? ))
-		ln -s /usr/include/${new}/${file} /usr/include/${file}
+		ln -s "${EPREFIX}"/usr/include/${new}/${file} "${EPREFIX}"/usr/include/${file}
 		retval=$((retval | $? ))
 	done
 	# executables
 	for file in mwm uil xmbind; do
-		rm -f /usr/bin/${file}
-		ln -s /usr/@@LIBDIR@@/${new}/${file} /usr/bin/${file}
+		rm -f "${EPREFIX}"/usr/bin/${file}
+		ln -s "${EPREFIX}"/usr/@@LIBDIR@@/${new}/${file} "${EPREFIX}"/usr/bin/${file}
 	done
 	# man pages
-	for file in `find /usr/share/man -regex ".*-${new}\..x?.gz"`; do
+	for file in `find "${EPREFIX}"/usr/share/man -regex ".*-${new}\..x?.gz"`; do
 		files="${files} ${file/-${new}/}"
 		rm -rf ${file/-${new}/}
 		retval=$((retval | $? ))
@@ -201,7 +206,7 @@
 	if [ $? -eq 1 ]; then
 		eerror "$0: No such profile: $profile"
 	else
-		echo "/usr/@@LIBDIR@@/${PROFILE}/"
+		echo "${EPREFIX}/usr/@@LIBDIR@@/${PROFILE}/"
 		exit 0
 	fi
 }
@@ -216,7 +221,7 @@
 	if [ $? -eq 1 ]; then
 		eerror "$0: No such profile: $profile"
 	else
-		echo "/usr/include/${PROFILE}/"
+		echo "${EPREFIX}/usr/include/${PROFILE}/"
 		exit 0
 	fi
 }
@@ -231,7 +236,7 @@
 	if [ $? -eq 1 ]; then
 		eerror "$0: No such profile: $profile"
 	else
-		echo "-I/usr/include/${PROFILE}/"
+		echo "-I${EPREFIX}/usr/include/${PROFILE}/"
 		exit 0
 	fi
 }
@@ -246,7 +251,7 @@
 	if [ $? -eq 1 ]; then
 		eerror "$0: No such profile: $profile"
 	else
-		echo "-L/usr/@@LIBDIR@@/${PROFILE}/"
+		echo "-L${EPREFIX}/usr/@@LIBDIR@@/${PROFILE}/"
 		exit 0
 	fi
 }
