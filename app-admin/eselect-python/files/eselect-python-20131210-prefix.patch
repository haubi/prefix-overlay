From 4c49cdcea51b8369e7b1a54ded2ab290b241a317 Mon Sep 17 00:00:00 2001
From: Mike Gilbert <floppym@gentoo.org>
Date: Sun, 19 Jan 2014 03:32:49 -0500
Subject: [PATCH] Respect EPREFIX in python-wrapper when reading config, bug
 498356 by jlec.

---
 Makefile.am      | 1 +
 python-wrapper.c | 6 +++++-
 2 files changed, 6 insertions(+), 1 deletion(-)

diff --git a/Makefile.am b/Makefile.am
index 69fd8d8..06f7d1c 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -1,4 +1,5 @@
 bin_PROGRAMS = python-wrapper
+python_wrapper_CPPFLAGS = -DENVD='"$(sysconfdir)/env.d"'
 
 eselectdir = $(datadir)/eselect/modules
 nodist_eselect_DATA = python.eselect
diff --git a/python-wrapper.c b/python-wrapper.c
index 6596c30..75a1de4 100644
--- a/python-wrapper.c
+++ b/python-wrapper.c
@@ -12,7 +12,11 @@
 #include <unistd.h>
 #include <sys/stat.h>
 
-#define ENVD_CONFIG "/etc/env.d/python/config"
+#ifndef ENVD
+#define ENVD "/etc/env.d"
+#endif
+
+#define ENVD_CONFIG ENVD "/python/config"
 
 /* 127 is the standard return code for "command not found" */
 #define EXIT_ERROR 127
-- 
1.8.3.2

