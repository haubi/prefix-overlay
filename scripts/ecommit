#!/usr/bin/env bash
# Copyright Gentoo Foundation 2006-2007

source "${EPREFIX:-$(portageq envvar EPREFIX)}"/etc/make.profile/make.defaults
kw="~$ACCEPT_KEYWORDS"

for i in $@; do
	svn add $i
	pushd $i > /dev/null
	if [[ $i != */* ]] ; then
		d=$(pwd)
		i=${d##*/}/$i
	fi
	# Force repoman to regenerate the Manifest and digests, it seems
	# that at least genstef often has repoman not committing the
	# Manifest when using this script.  This hack hopefully solves that.
	rm Manifest files/digest-*
	repoman commit -m "Add $i and keyword $kw"
	popd > /dev/null
done
