See https://bugs.freedesktop.org/show_bug.cgi?id=14259

===

From e0809d6c48641ab11e0dc1b3f537e56692208912 Mon Sep 17 00:00:00 2001
From: Benjamin Reed <rangerrick@befunk.com>
Date: Sun, 19 Jul 2009 11:30:39 -0400
Subject: [PATCH 1/7] make session bus <listen> tag configurable

---
 bus/session.conf.in |    2 +-
 configure.in        |    4 ++++
 2 files changed, 5 insertions(+), 1 deletions(-)

diff --git a/bus/session.conf.in b/bus/session.conf.in
index 85395c5..e121ff9 100644
--- a/bus/session.conf.in
+++ b/bus/session.conf.in
@@ -12,7 +12,7 @@
        the behavior of child processes. -->
   <keep_umask/>
 
-  <listen>unix:tmpdir=@DBUS_SESSION_SOCKET_DIR@</listen>
+  <listen>@DBUS_SESSION_BUS_DEFAULT_ADDRESS@</listen>
 
   <standard_session_servicedirs />
 
diff --git a/configure.in b/configure.in
index d79d655..5b88385 100644
--- a/configure.in
+++ b/configure.in
@@ -1286,6 +1286,10 @@ DBUS_SYSTEM_BUS_DEFAULT_ADDRESS="unix:path=$DBUS_SYSTEM_SOCKET"
 AC_SUBST(DBUS_SYSTEM_BUS_DEFAULT_ADDRESS)
 AC_DEFINE_UNQUOTED(DBUS_SYSTEM_BUS_DEFAULT_ADDRESS, "$DBUS_SYSTEM_BUS_DEFAULT_ADDRESS",[The default D-Bus address of the system bus])
 
+# set up the session bus address
+DBUS_SESSION_BUS_DEFAULT_ADDRESS="unix:tmpdir=$DBUS_SESSION_SOCKET_DIR"
+AC_SUBST(DBUS_SESSION_BUS_DEFAULT_ADDRESS)
+
 #### Set up the pid file
 if ! test -z "$with_system_pid_file"; then
    DBUS_SYSTEM_PID_FILE=$with_system_pid_file
-- 
1.6.3.2

